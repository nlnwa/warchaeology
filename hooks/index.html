<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=canonical href=https://nlnwa.github.io/warchaeology/hooks/><title>Hooks | Warchaeology
</title><link href=https://nlnwa.github.io/warchaeology/css/fontawesome.min.css rel=stylesheet><link rel=stylesheet href=https://nlnwa.github.io/warchaeology/css/ace.min.css></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id=navbarMain><div class=container><div><a class=navbar-brand href=/warchaeology>Warchaeology
</a>v4.1.3</div><button class="navbar-toggler navbar-toggler-right collapsed" type=button data-toggle=collapse data-target=#navbarMainCollapse aria-controls=navbarMainCollapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarMainCollapse><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://github.com/nlnwa/warchaeology><i class='fab fa-github'></i></a></li></ul></div></div></nav><div class=container-fluid><div class=row><div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0"><button class="navbar-toggler navbar-toggler-right collapsed" type=button data-toggle=collapse data-target=#sidenav-left-collapse aria-controls=sidenav-left-collapse aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse align-items-start flex-column" id=sidenav-left-collapse><ul class="navbar-nav flex-column pt-3"><li data-nav-id=/warchaeology/installation/ class="nav-item my-1"><a class="nav-link p-0" href=/warchaeology/installation/><h6>Installation</h6></a></li><li data-nav-id=/warchaeology/cmd/ class="nav-item my-1 haschildren"><a class="nav-link p-0" href=/warchaeology/cmd/><h6>Usage</h6></a><ul class="list-unstyled ml-2"><li data-nav-id=/warchaeology/cmd/warc/ class="nav-item my-1"><a href=/warchaeology/cmd/warc/ class="nav-link p-0">warc</a></li><li data-nav-id=/warchaeology/cmd/warc_cat/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_cat/ class="nav-link p-0">warc cat</a></li><li data-nav-id=/warchaeology/cmd/warc_console/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_console/ class="nav-link p-0">warc console</a></li><li data-nav-id=/warchaeology/cmd/warc_convert/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_convert/ class="nav-link p-0">warc convert</a></li><li data-nav-id=/warchaeology/cmd/warc_convert_arc/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_convert_arc/ class="nav-link p-0">warc convert arc</a></li><li data-nav-id=/warchaeology/cmd/warc_convert_nedlib/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_convert_nedlib/ class="nav-link p-0">warc convert nedlib</a></li><li data-nav-id=/warchaeology/cmd/warc_convert_warc/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_convert_warc/ class="nav-link p-0">warc convert warc</a></li><li data-nav-id=/warchaeology/cmd/warc_dedup/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_dedup/ class="nav-link p-0">warc dedup</a></li><li data-nav-id=/warchaeology/cmd/warc_ls/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_ls/ class="nav-link p-0">warc ls</a></li><li data-nav-id=/warchaeology/cmd/warc_validate/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_validate/ class="nav-link p-0">warc validate</a></li><li data-nav-id=/warchaeology/cmd/warc_version/ class="nav-item my-1"><a href=/warchaeology/cmd/warc_version/ class="nav-link p-0">warc version</a></li></ul></li><li data-nav-id=/warchaeology/config/ class="nav-item my-1"><a class="nav-link p-0" href=/warchaeology/config/><h6>Configuration</h6></a></li><li data-nav-id=/warchaeology/hooks/ class="nav-item my-1 active"><a class="nav-link p-0" href=/warchaeology/hooks/><h6>Hooks</h6></a></li><li data-nav-id=/warchaeology/contributing/ class="nav-item my-1"><a class="nav-link p-0" href=/warchaeology/contributing/><h6>Contributing</h6></a></li></ul></div></nav></div><div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-10 py-3"><h1>Hooks</h1><p>Warchaeology provides the ability to add hooks - executable files that run before and after opening/closing input and output files.</p><p>Hooks allow users to add custom logic and functionality to the file handling process and can be used to perform any necessary setup or validation before a file is accessed by the tool, or to perform any cleanup or post-processing tasks.</p><h3 id=execution>Execution</h3><blockquote><p>Please note that the executable files used as hooks should be able to run without any user interaction.</p></blockquote><p>They should also exit with a status code of 0 to indicate success. Any other exit status will be considered as an error by the tool. See details below for the exit codes used by each hook type.</p><p>The executable file must either be in the system&rsquo;s path or have a valid path. The program won&rsquo;t find a file using a path relative to the current directory. To use a program in the current directory, use <code>./program</code> or the full path.</p><p>Context for hooks is provided through environment variables, which are made available to the executable files. See details below for the environment variables available to each hook type.</p><h2 id=types-of-hooks>Types of hooks</h2><h3 id=openinputfilehook><em>OpenInputFileHook</em></h3><p>The <code>OpenInputFileHook</code> is an executable file that runs before an input file is opened.
This hook can be used to perform any necessary setup or validation before the file is accessed by the tool.
It can also be used to skip the file if it does not meet certain criteria.</p><p>To use this hook, specify the path to the executable file using the <code>--open-input-file-hook</code> flag when running the tool.</p><h4 id=environment-variables>Environment Variables</h4><ul><li><code>WARC_COMMAND</code>: Contains the subcommand name.</li><li><code>WARC_HOOK_TYPE</code>: Contains the hook type: OpenInputFile.</li><li><code>WARC_FILE_NAME</code>: Contains the file name of the input file.</li></ul><h4 id=exit-codes>Exit codes</h4><pre><code> 1: The hook should exit with a status of 1 in case of an error.
10: The hook should exit with a status of 10 to indicate that the file should be skipped.
</code></pre><h3 id=closeinputfilehook><em>CloseInputFileHook</em></h3><p>The <code>CloseInputFileHook</code> is an executable file that runs after an input file has been fully read and has been closed.
This hook can be used to perform any cleanup or post-processing tasks.</p><p>To use this hook, specify the path to the executable file using the <code>--close-input-file-hook</code> flag when running the tool.</p><h4 id=environment-variables-1>Environment Variables</h4><ul><li><code>WARC_COMMAND</code>: Contains the subcommand name.</li><li><code>WARC_HOOK_TYPE</code>: Contains the hook type: CloseInputFile.</li><li><code>WARC_FILE_NAME</code>: Contains the file name of the input file.</li><li><code>WARC_ERROR</code>: Contains the error message if there was an error processing the file.</li><li><code>WARC_ERROR_COUNT</code>: Contains the number of errors found processing the file.</li><li><code>WARC_HASH</code>: Contains the hash of the input file if it was computed.</li></ul><h4 id=exit-codes-1>Exit codes</h4><pre><code> 1: The hook should exit with a status of 1 in case of an error.
</code></pre><h3 id=openoutputfilehook><em>OpenOutputFileHook</em></h3><p>The <code>OpenOutputFileHook</code> is an executable file that runs before an output file is opened for writing.
This hook can be used to perform any necessary setup or validation before the file is accessed by the tool.</p><p>To use this hook, specify the path to the executable file using the <code>--open-output-file-hook</code> flag when running the tool.</p><h4 id=environment-variables-2>Environment Variables</h4><ul><li><code>WARC_COMMAND</code>: Contains the subcommand name.</li><li><code>WARC_HOOK_TYPE</code>: Contains the hook type: OpenOutputFile.</li><li><code>WARC_FILE_NAME</code>: Contains the file name of the output file.</li><li><code>WARC_SRC_FILE_NAME</code>: Contains the file name of the input file from which the output file is being created.</li></ul><h4 id=exit-codes-2>Exit codes</h4><pre><code> 1: The hook should exit with a status of 1 in case of an error.
</code></pre><h3 id=closeoutputfilehook><em>CloseOutputFileHook</em></h3><p>The <code>CloseOutputFileHook</code> is an executable file that runs after an output file has been fully written to and has been closed.
This hook can be used to perform any cleanup or post-processing tasks.</p><p>To use this hook, specify the path to the executable file using the <code>--close-output-file-hook</code> flag when running the tool.</p><h4 id=environment-variables-3>Environment Variables</h4><ul><li><code>WARC_COMMAND</code>: Contains the subcommand name.</li><li><code>WARC_HOOK_TYPE</code>: Contains the hook type: CloseOutputFile.</li><li><code>WARC_FILE_NAME</code>: Contains the file name of the output file.</li><li><code>WARC_SRC_FILE_NAME</code>: Contains the file name of the input file from which the output file was created.</li><li><code>WARC_SIZE</code>: Contains the size of the output file in bytes.</li><li><code>WARC_INFO_ID</code>: Contains the ID of the WarcInfo-record in the output file if it exists.</li></ul><div class=row></div></div></div></div><script src=https://nlnwa.github.io/warchaeology/lib/jquery.min.js></script><script src=https://nlnwa.github.io/warchaeology/lib/popper.min.js></script><script src=https://nlnwa.github.io/warchaeology/js/bootstrap.min.js></script><script type=text/javascript src=/warchaeology/plugins/lunr.min.js></script><script type=text/javascript src=/warchaeology/plugins/auto-complete.js></script><link href=/warchaeology/plugins/auto-complete.css rel=stylesheet><script type=text/javascript>var baseurl="https://nlnwa.github.io/warchaeology/"</script><script type=text/javascript src=/warchaeology/plugins/search.js></script><script type=text/javascript src=/warchaeology/plugins/clipboard.js></script><script>new ClipboardJS(".btn")</script></body></html>